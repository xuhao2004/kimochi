# 📱 小程序使用指南 - 简化版

## 🎯 **当前状态**

✅ **小程序已修复完成，可以正常使用！**

- 界面显示正常，不再空白
- 微信登录功能已修复
- 开发者工具完全可用
- 智能环境切换功能

---

## 🚀 **立即开始使用**

### **1. 微信开发者工具设置**
```
1. 打开微信开发者工具
2. 导入项目: /Users/douhao/Desktop/kimochi-dev/kimochi/mini-program/
3. 在「详情」→「本地设置」中：
   ✅ 不校验合法域名
   ✅ 不校验TLS版本  
   ✅ 不校验HTTPS证书
4. 点击「编译」
```

### **2. 环境管理 (重要！)**
```
进入小程序 → 我的 → 开发者工具：
- 🌐 环境信息 - 查看当前API配置
- 🔍 智能环境检测 - 自动检测并切换最佳环境
- 🔄 环境切换 - 手动切换开发/生产环境
```

---

## 🌐 **智能环境系统**

### **自动环境检测**
小程序会智能检测最佳环境：

1. **开发工具中**：
   - 首先尝试连接本地开发服务器 (`http://localhost:3001`)
   - 如果本地服务器不可用，自动切换到生产环境
   - 无需手动配置，完全自动化

2. **生产环境中**：
   - 直接使用生产服务器 (`https://47.104.8.84`)
   - 稳定可靠，无需本地服务器

### **手动环境管理**
如果需要手动控制：

```bash
# 方法1：使用小程序内置工具
我的 → 开发者工具 → 智能环境检测

# 方法2：启动本地开发服务器
./scripts/dev-server-simple.sh

# 方法3：直接启动 (如果npm配置正常)
npm run dev
```

---

## 📱 **功能测试**

### **基础功能**
```
✅ 首页 - 显示心语、天气、快捷入口
✅ 测评 - 心理测评列表和详情
✅ 心情墙 - 动态发布和浏览
✅ 消息 - 聊天功能
✅ 我的 - 个人中心和设置
```

### **登录功能**
```
✅ 微信登录 - 点击授权，正常登录
✅ 账号绑定 - 绑定现有账号
✅ 登录状态 - 自动保持登录
```

### **开发者功能**
```
✅ 环境信息 - 显示当前API配置和服务器状态
✅ 智能检测 - 自动检测最佳环境
✅ 环境切换 - 开发环境 ↔ 生产环境
✅ 调试面板 - 专业调试界面
✅ 性能监控 - 应用性能报告
✅ 清除缓存 - 清理本地数据
✅ 测试连接 - 验证API连接
```

---

## 🛠️ **故障排除**

### **问题1：界面空白**
```
解决方法：
1. 重新编译小程序
2. 清除缓存：我的 → 开发者工具 → 清除缓存
3. 检查控制台错误信息
```

### **问题2：微信登录失败** 
```
解决方法：
1. 确保是点击按钮触发的登录
2. 授权用户信息权限
3. 检查网络连接
```

### **问题3：API连接失败**
```
解决方法：
1. 使用智能环境检测：我的 → 开发者工具 → 智能环境检测
2. 会自动切换到可用的环境
3. 或手动切换到生产环境
```

### **问题4：本地开发服务器启动失败**
```
不用担心！小程序有智能环境切换：
1. 会自动检测本地服务器状态
2. 如果不可用，自动切换到生产环境
3. 功能完全正常，无需手动干预
```

---

## 🎉 **使用提示**

### **推荐工作流程**
```
1. 打开微信开发者工具
2. 导入项目并编译
3. 进入「我的」→「开发者工具」
4. 点击「智能环境检测」
5. 系统会自动配置最佳环境
6. 开始正常使用和开发
```

### **环境说明**
- **开发环境**: 需要本地服务器，适合开发调试
- **生产环境**: 使用线上服务器，稳定可靠
- **智能切换**: 自动选择可用环境，无需手动配置

---

## 📞 **需要帮助**

如果遇到任何问题：

1. **查看控制台**: 微信开发者工具中查看错误信息
2. **使用智能检测**: 我的 → 开发者工具 → 智能环境检测
3. **重新编译**: 工具栏中点击「编译」按钮
4. **清除缓存**: 我的 → 开发者工具 → 清除缓存

**🎯 小程序现在100%可用，可以开始愉快地开发和测试了！**
