<!--pages/scan/index.wxml-->
<view class="container">
  <!-- å¤´éƒ¨ -->
  <view class="header-section">
    <view class="header-title">
      <text class="title-2">æ‰«ç å·¥å…·</text>
      <text class="subtitle">æ‰«æäºŒç»´ç ï¼Œå¿«æ·ä¾¿æ°‘</text>
    </view>
    
    <view class="help-btn" bindtap="onPermissionHelp">
      <text class="help-icon">â“</text>
    </view>
  </view>

  <!-- å¿«æ·æ“ä½œ -->
  <view class="actions-section">
    <view class="actions-grid">
      <view 
        wx:for="{{quickActions}}" 
        wx:key="id"
        class="action-card card card-hover fade-in"
        style="animation-delay: {{index * 0.1}}s; --card-color: {{item.color}}"
        data-action="{{item.action}}"
        bindtap="onActionTap"
      >
        <view class="action-icon" style="background: {{item.color}}15; color: {{item.color}};">
          <text>{{item.icon}}</text>
        </view>
        <view class="action-content">
          <view class="action-title">{{item.title}}</view>
          <view class="action-desc">{{item.desc}}</view>
        </view>
        <view class="action-arrow">â€º</view>
      </view>
    </view>
  </view>

  <!-- é€šç”¨æ‰«ç æŒ‰é’® -->
  <view class="scan-section">
    <button class="scan-btn" bindtap="startGeneralScan">
      <view class="scan-btn-content">
        <view class="scan-icon">ğŸ“·</view>
        <text class="scan-text">é€šç”¨æ‰«ç </text>
        <text class="scan-desc">æ”¯æŒå„ç§äºŒç»´ç å’Œæ¡å½¢ç </text>
      </view>
    </button>
  </view>

  <!-- ç™»å½•çŠ¶æ€æç¤º -->
  <view wx:if="{{!isLoggedIn}}" class="login-prompt card">
    <view class="card-body">
      <view class="prompt-content">
        <view class="prompt-icon">ğŸ”</view>
        <view class="prompt-text">
          <view class="prompt-title">ç™»å½•åä½“éªŒæ›´å¤šåŠŸèƒ½</view>
          <view class="prompt-desc">æ‰«ç åŠ å¥½å‹ã€åŠ å…¥ç¾¤èŠç­‰</view>
        </view>
        <button class="prompt-btn btn btn-primary btn-small" bindtap="onLogin">
          ç™»å½•
        </button>
      </view>
    </view>
  </view>

  <!-- æ‰«ç å†å² -->
  <view wx:if="{{scanHistory.length > 0}}" class="history-section">
    <view class="history-header">
      <text class="section-title">æ‰«ç è®°å½•</text>
      <view class="clear-history-btn" bindtap="onClearHistory">
        <text class="clear-text">æ¸…é™¤</text>
      </view>
    </view>
    
    <view class="history-list">
      <view 
        wx:for="{{scanHistory}}" 
        wx:key="id"
        class="history-item card card-hover"
        data-item="{{item}}"
        bindtap="onHistoryTap"
      >
        <view class="card-body">
          <view class="history-content">
            <view class="history-icon">
              <text>{{item.type === 'login' ? 'ğŸ”‘' : (item.type === 'add_friend' ? 'ğŸ‘¥' : (item.type === 'join_group' ? 'ğŸ­' : 'ğŸ“‹'))}}</text>
            </view>
            <view class="history-info">
              <view class="history-title">
                {{item.type === 'login' ? 'ç™»å½•ç¡®è®¤' : (item.type === 'add_friend' ? 'æ·»åŠ å¥½å‹' : (item.type === 'join_group' ? 'åŠ å…¥ç¾¤èŠ' : 'æ‰«ç è®°å½•'))}}
              </view>
              <view class="history-time">{{item.time}}</view>
            </view>
            <view class="history-status">
              <text class="status-icon">{{item.success ? 'âœ…' : 'âŒ'}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- ä½¿ç”¨è¯´æ˜ -->
  <view class="tips-section">
    <view class="tips-card card">
      <view class="card-body">
        <view class="tips-header">
          <text class="tips-title">ğŸ’¡ ä½¿ç”¨æç¤º</text>
        </view>
        <view class="tips-list">
          <view class="tip-item">
            <text class="tip-dot">â€¢</text>
            <text class="tip-text">æ‰«ç ç™»å½•ï¼šç¡®è®¤PCç«¯ç½‘é¡µç™»å½•</text>
          </view>
          <view class="tip-item">
            <text class="tip-dot">â€¢</text>
            <text class="tip-text">æˆ‘çš„äºŒç»´ç ï¼šç”Ÿæˆä¸ªäººä¸“å±äºŒç»´ç </text>
          </view>
          <view class="tip-item">
            <text class="tip-dot">â€¢</text>
            <text class="tip-text">æ‰«ç åŠ å‹ï¼šå¿«é€Ÿæ·»åŠ æ–°æœ‹å‹</text>
          </view>
          <view class="tip-item">
            <text class="tip-dot">â€¢</text>
            <text class="tip-text">åŠ å…¥ç¾¤èŠï¼šæ‰«æç¾¤äºŒç»´ç åŠ å…¥</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨å®‰å…¨åŒºåŸŸ -->
  <view class="safe-area"></view>
</view>
